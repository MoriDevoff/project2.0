{% extends 'base.html' %}

{% block content %}
<div class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-6 md:p-8 fade-in">
    <h2 class="text-2xl md:text-3xl font-extrabold text-gray-900 mb-6 text-center">
        Чат с
        {% if request.user == chat_request.receiver %}
        {{ chat_request.sender.username }}
        {% else %}
        {{ chat_request.receiver.username }}
        {% endif %}
    </h2>
    <div class="mb-4">
        <p class="text-gray-600">Тема: {{ chat_request.car.brand }} {{ chat_request.car.model }}</p>
    </div>
    <div class="h-64 overflow-y-auto border rounded-lg p-4 mb-4 bg-gray-50">
        {% for message in messages %}
        <div class="mb-2 {% if message.sender == request.user %}text-right{% endif %}">
            <p class="inline-block p-2 rounded-lg {% if message.sender == request.user %}bg-blue-200{% else %}bg-gray-200{% endif %}">
                <strong>{{ message.sender.username }}:</strong> {{ message.content }}<br>
                <small class="text-gray-500">{{ message.timestamp|date:"d.m.Y H:i" }}</small>
            </p>
        </div>
        {% endfor %}
    </div>
    <form method="post" class="flex space-x-2">
        {% csrf_token %}
        <input type="text" name="message" class="flex-1 p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Введите сообщение..." required>
        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">Отправить</button>
    </form>
</div>
{% endblock %}